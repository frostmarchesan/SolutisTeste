//
//  LoginWorker.swift
//  SolutisTeste
//
//  Created by Virtual Machine on 26/11/21.
//  Copyright (c) 2021 ___ORGANIZATIONNAME___. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so
//  you can apply clean architecture to your iOS and Mac projects,
//  see http://clean-swift.com
//

import UIKit
import KeychainSwift

protocol LoginWorkerProtocol{
    func loginRequest(url: String, userLogin: String, userPassword: String, completionHandler: @escaping (Result<User, Error>) -> Void)
    
    func loginCheck(login: String) -> Bool
    
    func passwordCheck(password: String) -> Bool
}


class LoginWorker: LoginWorkerProtocol {
    
    var request = ServiceRequest()
    let keyChain = KeyChainModel()
    let validator = LoginValidator()
    
    func loginRequest(url: String, userLogin: String, userPassword: String, completionHandler: @escaping (Result<User, Error>) -> Void) {
        do {
            let apiRequest = try request.performLoginRequest(urlString: url, userLogin: userLogin, userPassword: userPassword, completion: completionHandler)
        } catch { return }
    }
    
    func saveUserKeyChain() {
        keyChain.storeData(data: "true", key: "boolean")
    }
    
    func dontSaveUserKeyChain() {
        keyChain.storeData(data: "false", key: "boolean")
    }
    
    func getKeyChain(key: String) -> String {
        return keyChain.getData(key: key)
    }

    func eraseKeyChain(key: String) {
        keyChain.eraseData(key: key)
    }
    
    func loginCheck(login: String) -> Bool {
        return validator.checkUserLog(entry: login)
    }
    
    func passwordCheck(password: String) -> Bool {
        return validator.checkPassword(password: password)
    }
    
}
